(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6491],{96491:function(n,t,e){"use strict";e.d(t,{j:function(){return C}});var l={};e.r(l),e.d(l,{button:function(){return i},inline:function(){return s},span:function(){return c}});var o=e(97458),a=e(32748);e(96341),e(94398),e(88869);var r=e(22319),i=(0,r.c)({defaultClassName:"_bglng83 _1286nb12iw _1286nb128w _1286nb123k _1286nb12dk _1286nb14ke _1286nb14lq _1286nb14n2 _1286nb14oe _1286nb12re _1286nb12o2 _1286nb13pk _1286nb119",variantClassNames:{mode:{follow:"_1286nb16ft _1286nb17t2 _1286nb17yz",following:"_1286nb16ft _1286nb16nh _1286nb17t2 _1286nb186q"}},defaultVariants:{mode:"follow"},compoundVariants:[]}),s=(0,r.c)({defaultClassName:"_bglng8a _bglng87 _1286nb119",variantClassNames:{mode:{follow:"_1286nb16ft",following:"_1286nb16ft _1286nb16nh"}},defaultVariants:{mode:"follow"},compoundVariants:[]}),c="_bglng8d",u=e(96005),f=e(42011),b=e(52983),_=e(51835),w=e(95815);let d=async()=>{let n=await fetch("/api/social/follow");if(!n.ok)throw Error();return await n.json()},h=(0,_.cn)({key:"userFollowsState",default:[],effects:[n=>{let{setSelf:t}=n;(async()=>{let n=async()=>await d();t(await n())})()}]}),m=(0,_.CG)({key:"authorUserFollow",get:n=>{let{id:t}=n;return n=>{let{get:e}=n;return!!e(w.UA)&&e(h).includes(t)}},set:n=>{let{id:t}=n;return(n,e)=>{let{get:l,set:o}=n,a=l(h);o(h,e?a.filter(n=>n!==t):[...a,t])}}});var g=e(51362);let k=async(n,t)=>{if(!(await fetch("/api/social/follow?id=".concat(t),{method:n?"DELETE":"PUT"})).ok)throw Error("There was a problem toggling the follow")};var p=e(62168);let N=(n,t)=>{let e=(0,p.PN)(),l={event:"ga4event",event_name:"follow_author",action:"follow_author",author_name:n,location:t,category:"follow-contributor"};return()=>e(l)},v=(n,t,e)=>{let[l,o]=(0,b.useState)(!0),{setToast:a}=(0,g.p)(),{loginUrl:r,setLoginCookies:i}=(0,u.J)(),s=(0,f.d)(),[c,w]=(0,_.FV)(m({id:n})),d=N(t,e),h=(0,b.useCallback)(()=>{if(!s){i(),window.location.href=r;return}o(!1),k(c,n).then(()=>w(c)).then(()=>!c&&d()).catch(()=>a()).finally(()=>o(!0))},[s,c,n,i,r,w,d,a]);return{following:c,disabled:!l,onClick:h}},C=n=>{let{id:t,name:e,location:r,buttonStyle:i="button"}=n,{t:s}=(0,a.$G)("common"),{following:u,onClick:f,disabled:b}=v(t,e,r),_="inline"===i?"inline":"button";return u?(0,o.jsxs)("button",{className:l[_]({mode:"following"}),onClick:f,disabled:b,children:[(0,o.jsx)("span",{className:c,children:s("following")}),(0,o.jsx)("span",{className:c,children:s("unfollow")})]}):(0,o.jsx)("button",{className:l[_](),onClick:f,disabled:b,children:s("follow")})}},88869:function(){}}]);